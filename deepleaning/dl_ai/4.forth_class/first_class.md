# 卷积神经网络

# 计算机视觉

来看看一些常见的应用：

- 熟悉的分猫器
- 物体标识
- 风格化图片

视觉处理中的问题是，输入可以无限大。

参数数量的计算：

图像所有信息，比如1000x1000x3，

## 卷积的例子

边缘检测

垂直检测、水平检测。

对于一个6x6的图片，有一个3x3的过滤器（filter），也有被称为核(kernel)

比如这里有一个3x3的过滤器：
$$
 \left[
 \begin{matrix}
   1 & 0 & -1 \\
   1 & 0 & -1 \\
   1 & 0 & -1 \\
  \end{matrix}
  \right] 
$$
对6x6的矩阵做卷积，使用$*$，这个符号。

输出的是一个4x4的矩阵。

![](jpg/1.JPG)

一般来说每个框架都由对应的卷积算法。

比如有图片有如下形式：

![](jpg/2.jpg)

这就相当于检测出了垂直的中间图像。

## 如何用他们

正边缘、负边缘。

![](jpg/3.jpg)

这样可以检测出从亮到暗、从暗到亮的过度。

以及各个学界也有对于使用什么filter有不同的见解。

![](jpg/4.jpg)

通过过滤器，可以发现深度学习可以学习很多底层特性。

将这九个数当成参数去学习。

## padding 填充

比如，一个$n\times n$的矩阵，使用$f\times f$的过滤器，会得到一个$(n-f+1)\times (n-f+1)$的结果图像。

这样会造成图片的缩小。

同时边界上的像素，实际上被用到的次数很少，会减少边界的信息。

解决方法是在使用卷积前，先填充一次图片，使其变成$(n+2p-f+1)\times (n+2p-f+1)$大小的。

valid就是不填充的，same就是填充，使其输出等于输入。

当然注意，过滤器最好是奇数。

## strided（带步长） 卷积

![](jpg/5.jpg)

就是如图所示，带着一定步长进行遍历。

向下移动也是一样的。

所以，一个$(n\times n) *(f\times f)$使用padding($p$),步长($s$)，这样可以得到一个$[\frac{n+2p-f}{s}+1]\times [\frac{n+2p-f}{s}+1]$的矩阵。

## 多维的卷积

比如对于三位，RGB三维。

![](jpg/6.jpg)

注意，这里也不一定只有一个过滤器。

## 单层卷积网络

假定网络中有10个3,3,3过滤器，那么这一层有多少参数。

每个过滤器都由27个参数。还有一个b。就是28个。

这里使用，当标识$l$层是一个卷积层，那么$f^{[l]}$标识这一层的过滤器大小。

$p^{[l]}$标识这一层的填充，$s^{[l]}$表示步长。

Input：$n_h^{[l-1]}\times n_w^{[l-1]}\times n_c^{[l-1]}$。

Output：$n_h^{[l]}\times n_w^{[l]}\times n_c^{[l]}$

其中：$n^{[l]}=\lfloor \frac{n^{[l-1]}+2*p^{[l]}-f^{[l]}}{s^{[l]}}+1 \rfloor$,w或者h。

## 一个简单的例子

![](jpg/7.jpg)

对于一般的卷积来说，有三层：

- 卷积层 convolution(conv)
- 池化层pooling(pool)
- 全连接层 fully connected(FC)

## 池化层

比如对于max pooling：

![](jpg/8.jpg)

就是拆分，取每块最大值。

当然也可以用类似卷积层一样的移动框框的方式来搞。

![](jpg/9.jpg)

还有平均值池化（这个不也是个卷积？）

以及这一层是不需要学习的。

## CNN示例

对于一个32x32x3的图片，需要识别其中的数字。

这里注意，这里会将卷积层与池化层化作一层。因为一般来说，称带有权重、参数的层才能成为一层。

经过多次卷积、池化后的的第一个标准神经网络层，被称为全连接层(FC,Full connect)。

![](jpg/10.jpg)

## CNN的优势

- 全连接会造成，存在很多很多的W参数需要学习。比如一个1000×1000的图片，那么会有一个很大很大的数量级，这个并不适合于深度学习。

- <!--同时还能降不同的图片给归一化-->

- 参数共享：在特征检测中，图像的一部分是有用的，那么另外一部分也是有用的。(意味着一定程度上的连续性。)

- 避免了很多稀疏矩阵。

  可以帮助神经网络更好地辨别平移不变性等。

## 题目：

1. 垂直检测
2. 300x300RGB，100个神经元，全连接，参数数量：270...01【错】，27000100
3. 300x300RGB，100个5x5滤波，参数数量：2501【错】，25x100+100？【错】
4. 63x63x16,32个7x7过滤，2s,0p。输出：29，29，32
5. 15x15x8，pad2.:输出19,19,8
6. 63,63,16,32个7x7滤波，1s，相同的卷积，使用：3p
7. 池化32x32x16,max,2s,2x2。输出：16,16,16
8. 否
9. 选，减少参数和多个特征检测器
10. 链接的稀疏性，仅依赖于前一层的少量