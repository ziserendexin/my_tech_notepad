# 人脸识别

- 人脸识别
- 活体识别

这里只说人脸识别部分。主要有两种步骤

- 人脸校验

  只检测，人脸是不是其所称的人。是一个1:1问题。假设只需要99%的正确率。

- 人脸识别

  需要从K人中检测，如果K=100，那么就相当于其1:1的准确率就得提高一个量级了。

## 单样本问题

需要解决只有一个样本的学习问题。

只通过一张照片的前提下，认出一个人。

一般而言，只有一个样本的学习效果不会太好。

按照以前的想法，直接softmax出K个对象的概率的方式，就不会太好了。

这里最常用的是训练一个相似函数（$d(img1,img2) >?<degree$），查看两个图片是否是一个人。

## Siamese网络

把图片$x^{(i)}$，经过一个神经网络，进行编码，得到一个$f(x^{(i)})$，比如将其重新表达为一个128维的。

对另外一张图片进行类似的编码。

![](jpg/40.jpg)

然后就可以定义$d(x^{(1)},x^{(2)})$，比如是其二范数。这时候就可以判断了。

那么问题就转变为创造一个网络，使其对同一个人能生成同样的encode。

## 三元组损失函数

一个损失函数，需要同时观察3个照片（这个三元的意思）：

1. 锚照片，ancher，A
2. 正例，positive，P
3. 反例，negative，N

那么对于损失函数有如下性质：
$$
\|f(A)-f(P)\|\leq \|f(A)-f(N)\| \\
\|f(A)-f(P)\|- \|f(A)-f(N)\|+\alpha \leq 0
$$

> 以上任务，有个很简单的学习方式，就是将任何图片的输出都变成0，那么0-0自然满足条件，所以这里需要做一个修改，增加一个$\alpha$(也被称为margin)，使其不能一直为0。
>

同时我们还希望$d(A,P)$远小于$d(A,N)$，那么这个margin就得大一些。

于是这个alpha就是个很好的超参数。
$$
\mathscr{L}(A,P,N)=max(\|f(A)-f(P)\|- \|f(A)-f(N)\|+\alpha,0)
$$
当然也需要很多同一个人，不同的照片，比如1w张1k人的照片，每个人10张。

当然，在训练的过程中，因为照片是随机选取的，所以约束条件比较容易满足，也就代表没法学到什么，于是需要一组学起来比较难的三元组。