> <https://mp.weixin.qq.com/s/4e9l-GP22T-myP54hJJjPA>

首先要知道k8s是解决什么问题，它，能干什么。

## 背景

### PaaS

PaaS 技术，一句话概括就是：它提供了“应用托管”的能力。

早期的主流做法基本上是租 AWS 或者 OpenStack 的虚拟机，然后把这些虚拟机当作物理机一样，用脚本或者手工的方式在上面部署应用。这个过程中如何保证本地环境和云端环境的一致性是一个很大的课题，而提供云计算服务的公司的核心竞争力就是比拼谁做的更好。

### 分布式系统

服务构架，从单体变成SOA、微服务。可能还是将来的service mesh、serverless。

如今，一个完整的后端系统不再是单体应用架构了，多年前的 DDD 概念重新回到大家的视线中。

### 容器技术

诸如 Cloud Foundry 的 PaaS，用户必须为不同语言、不同框架区分不同的打包方式。

然后docker横空出世。

干脆把完整的操作系统也给打包进去。因为有了镜像的功能。

### CaaS

某些技术公司跟进，推出了自己啊的容器集群管理，成为CaaS。

容器技术利用 Namespace 实现隔离，利用 Cgroups 实现限制；在 Docker 实现上，通过镜像，为容器提供完整的系统执行环境，并且通过 UnionFS 实现 Layer 的设计。

### Kubernetes

说 Kubernetes 之前，不得不提 Compose、Swarm、Machine 三剑客，其实在 Kubernetes 还未一统江湖之前，它们已经能实现大部分容器编排的能力了。

# 设计理念

### **声明式 VS 命令式** 

声明式和命令式是截然不同的两种编程方式，在命令式 API 中，我们可以直接发出服务器要执行的命令，例如： “运行容器”、“停止容器”等；在声明式 API 中，我们声明系统要执行的操作，系统将不断向该状态驱动。

常用的 SQL 就是一种声明式语言，告诉数据库想要的结果集，数据库会帮我们设计获取这个结果集的执行路径，并返回结果集。众所周知，使用 SQL 语言获取数据，要比自行编写处理过程去获取数据容易的多。

[^]: 这个不好说吧，SQL的学习成本，精通成本，也不见得比自己手写要低。



### 显式的 API

Kubernetes 是透明的，它没有隐藏的内部 API。换句话说 Kubernetes 系统内部用来交互的 API 和我们用来与 Kubernetes 交互的 API 相同。

### 无侵入性

感谢 Docker 容器技术的流行，使得 Kubernetes 为大家提供了无缝的使用方式。在容器化的时代，我们的应用达到镜像后，不需要改动就可以遨游在 Kubernetes 集群中。

Kubernetes 还提供存储 Secret、Configuration 等包含但不局限于密码、证书、容器镜像信息、应用启动参数能力。如此，Kubernetes 以一种友好的方式将这些东西注入 Pod，减少了大家的工作量，而无需重写或者很大幅度改变原有的应用代码。

[^]: 这个的确是，最近在使用gitlab-runner上，笨拙地使用环境变量的方式。

### 有状态的移植

假设一个大型分布式系统使用了多家云厂商的存储方案，如何做到开发者无感于底层的存储技术体系，并且做到方便的移植？

## 架构

标准C/S模型。

